SELECT A.CRSE_ID, A.CRSE_OFFER_NBR, A.STRM, A.SESSION_CODE, A.CLASS_SECTION, B.EMPLID, B.LAST_NAME, B.FIRST_NAME
  FROM PS_CLASS_INSTR A, PS_NAMES_VW B
  WHERE ( A.EMPLID = B.EMPLID
     AND B.EFFDT =
        (SELECT MAX(B_ED.EFFDT) FROM PS_NAMES_VW B_ED
        WHERE B.EMPLID = B_ED.EMPLID
          AND B.NAME_TYPE = B_ED.NAME_TYPE
          AND B_ED.EFFDT <= SYSDATE)
     AND A.CRSE_ID = '010057'
     AND A.CRSE_OFFER_NBR = 2
     AND A.STRM = '2192'
     AND A.SESSION_CODE = '1'
     AND B.NAME_TYPE = 'PRF'
     AND B.EFFDT =
        (SELECT MAX(B_ED.EFFDT) FROM PS_NAMES_VW B_ED
        WHERE B.EMPLID = B_ED.EMPLID
          AND B.NAME_TYPE = B_ED.NAME_TYPE
          AND B_ED.EFFDT <= SYSDATE))
