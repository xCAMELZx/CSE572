
SELECT A.CRSE_ID, A.ACAD_GROUP, A.SUBJECT, A.CATALOG_NBR, A.ACAD_ORG, B.ACAD_GROUP, B.DESCR, C.ACAD_ORG, C.DESCR
FROM PS_CRSE_OFFER A, PS_ACAD_GROUP_TBL B, PS_ACAD_ORG_TBL C
WHERE ( B.ACAD_GROUP = A.ACAD_GROUP
  AND B.INSTITUTION = A.INSTITUTION
  AND ( A.EFFDT =
      (SELECT MAX(A_ED.EFFDT) FROM PS_CRSE_OFFER A_ED
      WHERE A.CRSE_ID = A_ED.CRSE_ID
        AND A_ED.EFFDT <= SYSDATE)
   AND B.EFFDT =
      (SELECT MAX(B_ED.EFFDT) FROM PS_ACAD_GROUP_TBL B_ED
      WHERE B.INSTITUTION = B_ED.INSTITUTION
        AND B.ACAD_GROUP = B_ED.ACAD_GROUP
        AND B_ED.EFFDT <= A.EFFDT)
   AND C.ACAD_ORG = A.ACAD_ORG
   AND C.EFFDT =
      (SELECT MAX(C_ED.EFFDT) FROM PS_ACAD_ORG_TBL C_ED
      WHERE C.ACAD_ORG = C_ED.ACAD_ORG
        AND C_ED.EFFDT <= SYSDATE)
   AND A.ACAD_ORG = '189' ))
